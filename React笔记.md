# React

##虚拟dom

需要先解释DOM：DOM是使用JavaScript对象来表示页面中的元素

而虚拟dom是框架中的概念，是我们程序员用js对象来模拟页面上的DOM和嵌套DOM。

我们平时在使用JavaScript操作DOM时，其实就是对页面进行重排和重绘，其实这是非常消耗性能的，试想，我们在使用ajax发送异步请求后，我们会得到一些数据，我们平时对页面的操作，其实是对数据的操作，就像一个数组，如果它的长度很长，那么我们大可不必要关心那些没有变化的数据，换句话说，数组中的某项或者多项，在数组中如果没有数值以及位置上的变化，我们是没有必要对这些项进行重排或者重绘的，顺着这个想法，我们只需要处理那些变动的东西，一样可以使页面得到相应的更新，与此同时，还可以大幅度地提高性能。

那么问题来了，我们在操作DOM时，实际上是通过浏览器提供的各种API，获得页面中的各个元素，使得我们可以修改每个元素的属性与样式，以此间接地修改DOM树，而DOM树本身并没有提供接口让我们直接可以操作我们熟悉而又陌生的DOM树，因为我们无法获取浏览器内存中的整个DOM树。为了解决这个问题，框架就诞生了，我们致力于构造两个DOM树，用后生成的DOM与之前生成的DOM树进行对比，只需要更新不同的地方即可，而创造这两个DOM树的方法，还是使用我们熟知的JavaScript。试想下面的Html：

```html
<div id="myDiv" title="说实话">我挺帅的
    <p>哈哈哈</p>
</div>
```

这个代码没有什么难度，但是我们可以通过JavaScript模拟构造这么一个html的元素：

```javascript
var div = {
    tagName: 'div',
    attrs: {
        id: 'myDiv',
        title: '说实话'
    },
    childrens: [
        '我挺帅的',
        {
         	tagName: 'p',
            attrs: {},
            childrens: [
                '哈哈哈'
            ]
        }
    ]
}
```

DOM的嵌套我们可以通过`childrens`属性来嵌套，运用这种思想，我们就可以再创造一个DOM元素。两者进行对比，就是遍历对象中同一属性的不同值，更新该值就可以。

所谓的虚拟DOM，其实就是使用JavaScript的形式，来模拟页面DOM之间的嵌套关系，即，虚拟DOM是以JS对象的形式存在的，其本质是为了实现页面元素高效的按需更新。

## Diff算法（差异查询算法）

- tree diff

  新旧两颗DOM树，逐层对比的过程，当该过程的完成，就能够找到需要更新的元素。

- component diff

  在进行tree diff的过程中，组件之间的对比。如果对比前后，组件的类型相同，如果类型相同，则暂时认为这个组件不需要被更新。如果组件类型不同，则需要移除旧组件，创建新的组件，并追加到页面上

- element diff

  在进行component diff的过程中，如果两个组件相同，则需要进行元素级别的对比。

三个diff算法逐层递进，使得整两个DOM树的对比没有遗漏。

## 安装

1. 运行`npm i react react-dom -S`安装包
   + react:  专门用于创建组件和虚拟DOM的，同时组件的声明周期都在这个包中
   + react-dom: 专门进行dom操作，主要用于`ReactDOM.render()`，将我们生成好的虚拟DOM渲染到页面上（因为我们生成的虚拟DOM在浏览器的内存中）

2. 初探：

   ```javascript
   import React from 'react'
   import ReactDOM from 'react-dom'
   
   // 创建虚拟DOM元素
   // 参数1： 创建元素的类型， 接受字符串，表示元素的名称
   // 参数2: 是一个对象或者null，表示当前这个DOM元素的属性
   // 参数3：子节点(包括其它虚拟DOM获取的文本子节点)
   // 参数n：其它子节点
   // <h1 id="myh1" title="this is a h1">这是一个大大的h1</h1>
   const myh1 = React.createElement('h1', {id: 'myh1', title: "this is a h1"}, '这是个大大的h1')
   
   // 使用ReactDOM把虚拟DOM渲染到页面上
   // 参数1：要渲染的那个虚拟DOM元素
   // 参数2：指定页面上的容器
   ReactDOM.render(myh1, document.getElementById('app'))
   ```

   当然，我们可以这么创建一个元素，但是真正在书写前端页面的时候，一个页面就有成百上千个元素，所以，这么做成本实在太高了。为了能够实现快速开发，我们想到了在js文件中书写我们的HTML代码，但是js原本的语法并不允许我们这样做。由此，生成了JSX语法。

## JSX语法

