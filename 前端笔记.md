# 前端笔记

## 前端性能优化

潜在的性能优化点：

1. dns是否可以通过缓存减少dns查询时间
2. 网络请求的过程走最近的网络环境
3. 相同的静态资源是否可以缓存
4. 能否减少请求http请求大小
5. 减少http请求数量
6. 服务端渲染



### 压缩与合并



## 浏览器

浏览器功能:呈现`web`资源.

工作机制:

1. 输入网址 
2. 浏览器查找域名的`IP`地址。 
3. 浏览器给web服务器发送一个`HTTP`请求 
4. 网站服务的永久重定向响应 
5. 浏览器跟踪重定向地址 现在，浏览器知道了要访问的正确地址，所以它会发送另一个获取请求。 
6. 服务器“处理”请求，服务器接收到获取请求，然后处理并返回一个响应。 
7. 服务器发回一个`HTML`响应 
8. 浏览器开始显示`HTML` 
9. 浏览器发送请求，以获取嵌入在`HTML`中的对象

我们先来了解一下一个`html`页面怎么被渲染最后呈现到浏览器用户眼前的.

### 渲染

由渲染引擎执行,会解析三种文件,`HTML`,`CSS`与`JS`,主要会经历这几个步骤

1. 解析`html`以构建`dom`树 -> 2. 构建`render`树 -> 3.布局`render`树 ->4. 绘制`render`树

渲染引擎会首先渲染解析`HTML`文件,第一步将每个`html`元素转换成一个`DOM`节点构建一棵`DOM`树,样式信息与HTML中的可视化指令一起用于创建渲染树,在构建渲染树后,根据`CSS`中的位置属性参与布局过程,每个`DOM`节点有自己的确切的坐标,最后是绘制阶段,渲染引擎将遍历整个渲染树,并使用UI后端层绘制每个节点.

输出树 - 解析树是DOM元素和属性节点的树。它是HTML文档的对象呈现和HTML元素与外部世界的接口.HTML5规范描述了解析算法,该算法包括两个阶段 - 标记化和树形结构。标记化是词法分析，将输入解析为标记。HTML标记包括开始标记，结束标记，属性名称和属性值。



- 标记化算法

初始状态是“数据状态”。遇到“<”字符时，状态将更改为**“标记打开状态”**。使用“az”字符会导致创建“开始标记令牌”，状态将更改为**“标记名称状态”**。我们保持这种状态直到消耗“>”字符。每个字符都附加到新令牌名称。到达“>”标记时，将发出当前标记，并且状态将更改回**“数据状态”**。

- 树构造算法

创建解析器时，将创建Document对象。在树构建阶段，将修改其根目录中包含Document的DOM树，并将元素添加到其中。标记生成器发出的每个节点都将由树构造函数处理。对于每个标记，规范定义哪个DOM元素与其相关，并将为此标记创建。除了将元素添加到DOM树之外，它还被添加到一堆开放元素中。

- 渲染树

在构建DOM树时，浏览器构造另一个树，即渲染树。该树具有视觉元素，按其显示顺序排列。它是文档的直观表示。此树的目的是以正确的顺序绘制内容。构建渲染树需要计算每个渲染对象的可视属性。渲染器对应于DOM元素，但关系不是一对一的。非可视DOM元素不会插入渲染树中。此外，显示属性分配为“无”的元素也不会出现在树中（具有“隐藏”可见性属性的元素将显示在树中）。

- 布局

创建渲染器并将其添加到树中时，它没有位置和大小。计算这些值称为布局或重排。布局是一个递归过程。它从根渲染器开始，它对应于HTML文档的元素。布局以递归方式继续通过部分或全部帧层次结构，计算需要它的每个渲染器的几何信息。

- 绘制

在绘制阶段，遍历渲染树并调用渲染器“绘制”方法以在屏幕上显示其内容。

### 脚本

网络模型是同步的。解析文档会暂停，直到执行脚本为止。如果脚本是外部的，则必须首先从网络中获取资源 - 这也是同步完成的，解析将暂停，直到获取资源。Webkit和Firefox都进行了这种优化。在执行脚本时，另一个线程会解析文档的其余部分，并找出需要从网络加载的其他资源并加载它们。这些方式可以在并行连接上加载资源，整体速度更好。注意 - 推测解析器不会修改DOM树并将其留给主解析器，它只解析对外部脚本，样式表和图像等外部资源的引用。


当txt文件被导入(require或者import)的时候,先使用`raw-loader`转换一下,再打包.

## 客户端存储

客户端存储遵循同源策略，所以不同站点的页面是无法互相读取对方存储的数据，但是统一站点的不同页面之间可以互相共享存储数据。

## 前端工程笔记

1. 在样式中引入样式文件的时候一定要在路径前面加`~`

   ```vue
   <style lang="stylus" scoped>
     @import "~style/varibles.styl"
   </style>
   ```

2. 可以通过`webpack.base.config.js`对一些常用路径进行配置，记得修改了之后要重启服务器：

   ```vue
    resolve: {
       extensions: ['.js', '.vue', '.json'],
       alias: {
         'vue$': 'vue/dist/vue.esm.js',
         '@': resolve('src'),
         'style': resolve('src/assets/style')
       }
    },
   ```

3. 对于没有后端支持的前期，如果需要访问接口，可以在`/static`目录下新建`/mock`文件夹，然后在该文件中增加本地数据项，然后在`/config`目录下的`index.js`文件中找到`dev`属性，对其proxyTable属性进行配置，意思就是可以通过这个配置项目，将ajax请求代理到开发者想要代理的位置：

   ```javascript
   proxyTable: {
         '/api': {
           target: 'http://localhost:8080',
           pathRewrite: {
             '^/api': '/static/mock'
           }
         }
       },
   ```

4. 性能优化问题-数据多造成的渲染延时

   可以通过制作表格分页，按需渲染查看数据，这样渲染的数据量比较小，不会存在明显的延时问题。

5. 性能优化问题-函数节流提高用户频繁操作产生的渲染问题

   ```javascript
   if (timer) {
       clearTimeout(timer)
   }
   timer = setTimeout(() => {
       // ...
   }, 16)
   ```

## 小程序

